!(function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;"undefined"!=typeof window?a=window:"undefined"!=typeof global?a=global:"undefined"!=typeof self&&(a=self),a.express=b()}}})(function(){var d,b,a;return(function c(f,k,h){function g(n,l){if(!k[n]){if(!f[n]){var i=typeof require=="function"&&require;if(!l&&i){return i(n,!0)}if(e){return e(n,!0)}throw new Error("Cannot find module '"+n+"'")}var m=k[n]={exports:{}};f[n][0].call(m.exports,function(o){var p=f[n][1][o];return g(p?p:o)},m,m.exports,c,f,k,h)}return k[n].exports}var e=typeof require=="function"&&require;for(var j=0;j<h.length;j++){g(h[j])}return g})({1:[function(i,g,e){var f=new Class();f.property("resolve",function(j){if(j.length===0){return}else{if(j.length===1){return j[0]}else{return j}}});f.define("get",function(j){return this["private"]("resolve")(_.enumerate(Request.QueryString(j)))});f.define("form",function(j){return this["private"]("resolve")(_.enumerate(Request.Form(j)))});f.define("getAll",function(){var k={},j=this;_.each(_.enumerate(Request.QueryString),function(l){k[l]=j.get(l)});return k});f.define("formAll",function(){var k={},j=this;_.each(_.enumerate(Request.Form),function(l){k[l]=j.form(l)});return k});f.define("host",process.env.HTTP_HOST);f.define("agent",process.env.HTTP_USER_AGENT);var h=String(Request.ServerVariables("HTTP_REFERER"));if(h&&h.length>0&&h!="undefined"){}else{h=false}f.define("referer",h);g.exports=f},{}],2:[function(i,g,e){var f=i("url"),h=g.exports=new f();h.params={};h.query={};h.protocol=process.env.SERVER_PORT;h.ip=process.env.LOCAL_ADDR||process.env.REMOTE_ADDR||process.env.REMOTE_HOST;h.agent=process.env.HTTP_USER_AGENT;h.method=process.env.REQUEST_METHOD.toLowerCase()},{url:1}],3:[function(g,f,e){(function(h){if(typeof e=="object"||typeof e==="function"&&typeof f=="object"){f.exports=h()}else{if(typeof d=="function"&&d.amd){return d(["jquery"],h)}else{window.md5=h(jQuery)}}})(function(s){var v=false;if(!s){var o=s={},v=true;s.isFunction=function(h){return typeof h==="function"};s.isArray=function(h){return typeof h==="array"};var w=Object.prototype.hasOwnProperty,y=Object.prototype.toString,p=function(h){if(!h||y.call(h)!=="[object Object]"||h.nodeType||h.setInterval){return false}if(h.constructor&&!w.call(h,"constructor")&&!w.call(h.constructor.prototype,"isPrototypeOf")){return false}var i;for(i in h){}return i===undefined||w.call(h,i)};s.isPlainObject=p;s.extend=function(){var C=arguments[0]||{},D=1,h=arguments.length,m=false,l,i,k,j;if(typeof C==="boolean"){m=C;C=arguments[1]||{};D=2}if(typeof C!=="object"&&!o.isFunction(C)){C={}}if(h===D){C=this;--D}for(;D<h;D++){if((l=arguments[D])!=null){for(i in l){k=C[i];j=l[i];if(C===j){continue}if(m&&j&&(o.isPlainObject(j)||o.isArray(j))){var n=k&&(o.isPlainObject(k)||o.isArray(k))?k:o.isArray(j)?[]:{};C[i]=o.extend(m,n,j)}else{if(j!==undefined){C[i]=j}}}}}return C};var q={}}else{var o=s}var u=/\+/g;function r(h){return x.raw?h:encodeURIComponent(h)}function B(h){return x.raw?h:decodeURIComponent(h)}function t(h){return r(x.json?JSON.stringify(h):String(h))}function z(i){if(i.indexOf('"')===0){i=i.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{i=decodeURIComponent(i.replace(u," "));return x.json?JSON.parse(i):i}catch(h){}}function A(i,j){var h=x.raw?i:z(i);return s.isFunction(j)?j(h):h}var x=s.cookie=function(E,F,m){if(F!==undefined&&!s.isFunction(F)){m=s.extend({},x.defaults,m);if(typeof m.expires==="number"){var D=m.expires,n=m.expires=new Date();n.setDate(n.getDate()+D)}if(!m.httponly){m.httponly=true}var G=[r(E),"=",t(F),m.expires?"; expires="+m.expires.toUTCString():"",m.path?"; path="+m.path:"",m.domain?"; domain="+m.domain:"",m.secure?"; secure":""].join("");if(v){G=G.replace(/\;$/,"");if(m.httponly){G+="; HttpOnly"}Response.AddHeader("Set-Cookie",G);return G}else{window.document.cookie=G;return G}}var k=E?undefined:{};var C;if(v){C=String(Request.ServerVariables("HTTP_COOKIE"))||"";if(C=="undefined"){C=""}C=C&&C.length>0?C.split("; "):[]}else{C=q.cookie?q.cookie.split("; "):[]}for(var H=0,i=C.length;H<i;H++){var h=C[H].split("=");var l=B(h.shift());var j=h.join("=");if(E&&E===l){k=A(j,F);break}if(!E&&(j=A(j))!==undefined){k[l]=j}}return k};x.defaults={};s.removeCookie=function(h,i){if(s.cookie(h)===undefined){return false}s.cookie(h,"",s.extend({},i,{expires:-1}));return !s.cookie(h)};if(v){return s}})},{}],4:[function(h,g,e){var i=h("cookie"),f=g.exports=new Global.watcher();f.buffers=[];f.handles=[];f._jsons={};f.cookie=function(){return i.cookie.apply(i,arguments)};f.clearCookie=function(){return i.removeCookie.apply(i,arguments)};f.get=function(j){return process.env[j]};f.set=function(j,l){var k=this;if(!l){_.each(j,function(m,n){k.set(n,m)})}else{Response.AddHeader(j,l)}return this};f.charset=function(j){Response.Charset=j};f.log=function(){f.buffers.push(Array.prototype.slice.call(arguments,0).join(""))};f.json=function(j){f._jsons=_.extend(f._jsons,j)};f.clear=function(){f.buffers=[]};f.end=function(k){var j;if(_.isFunction(k)){k.call(this,this.buffers)}else{if(_.isString(k)){this.log(k)}else{if(_.isObject(k)){this.json(k)}else{j=this.buffers.join("");if(f.handles.length>0){_.each(f.handles,function(l){if(_.isFunction(l)){var m=l(f.req,f);if(m){j=m}}})}if(!j){j=JSON.stringify(f._jsons)}}}}j&&j.length>0&&console.log(j)}},{cookie:3}],5:[function(f,g,m){var n=_.isArray;var j=new RegExp(["(\\\\.)","([\\/.])?(?:\\:(\\w+)(?:\\(((?:\\\\.|[^)])*)\\))?|\\(((?:\\\\.|[^)])*)\\))([+*?])?","([.+*?=^!:${}()[\\]|\\/])"].join("|"),"g");function p(q){return q.replace(/([=!:$\/()])/g,"\\$1")}function o(q,r){q.keys=r;return q}function h(q){return q.sensitive?"":"i"}function i(t,s){var q=t.source.match(/\((?!\?)/g);if(q){for(var r=0;r<q.length;r++){s.push({name:r,delimiter:null,optional:false,repeat:false})}}return o(t,s)}function e(v,s,q){var u=[];for(var r=0;r<v.length;r++){u.push(k(v[r],s,q).source)}var t=new RegExp("(?:"+u.join("|")+")",h(q));return o(t,s)}function l(t,s){var q=0;function r(A,u,w,z,D,y,B,C){if(u){return u}if(C){return"\\"+C}var v=B==="+"||B==="*";var x=B==="?"||B==="*";s.push({name:z||q++,delimiter:w||"/",optional:x,repeat:v});w=w?("\\"+w):"";D=p(D||y||"[^"+(w||"\\/")+"]+?");if(v){D=D+"(?:"+w+D+")*"}if(x){return"(?:"+w+"("+D+"))?"}return w+"("+D+")"}return t.replace(j,r)}function k(w,v,u){v=v||[];if(!n(v)){u=v;v=[]}else{if(!u){u={}}}if(w instanceof RegExp){return i(w,v,u)}if(n(w)){return e(w,v,u)}var s=u.strict;var r=u.end!==false;var t=l(w,v);var q=w.charAt(w.length-1)==="/";if(!s){t=(q?t.slice(0,-2):t)+"(?:\\/(?=$))?"}if(r){t+="$"}else{t+=s&&q?"":"(?=\\/|$)"}return o(new RegExp("^"+t,h(u)),v)}g.exports=k},{}],6:[function(f,g,k){var l=f("path-to-regexp");var h=Object.prototype.hasOwnProperty;function i(q,o,p){if(!(this instanceof i)){return new i(q,o,p)}o=o||{};this.handle=p;this.name=p.name||"<anonymous>";this.params=undefined;this.path=undefined;this.regexp=l(q,this.keys=[],o);if(q==="/"&&o.end===false){this.regexp.fast_slash=true}}i.prototype.handle_error=function j(o,t,p,r){var q=this.handle;if(q.length!==4){return r(o)}try{q(o,t,p,r)}catch(s){r(s)}};i.prototype.handle_request=function n(s,o,q){var p=this.handle;if(p.length>3){return q()}try{p(s,o,q)}catch(r){q(r)}};i.prototype.match=function m(x){if(x==null){this.params=undefined;this.path=undefined;return false}if(this.regexp.fast_slash){this.params={};this.path="";return true}var r=this.regexp.exec(x);if(!r){this.params=undefined;this.path=undefined;return false}this.params={};this.path=r[0];var w=this.keys;var s=this.params;var o;var p=0;var v;var q;for(var t=1,u=r.length;t<u;++t){v=w[t-1];o=v?v.name:p++;q=e(r[t]);if(q!==undefined||!(h.call(s,o))){s[o]=q}}return true};function e(q){if(typeof q!=="string"){return q}try{return decodeURIComponent(q)}catch(p){var o=new TypeError("Failed to decode param '"+q+"'");o.status=400;throw o}}g.exports=i},{"path-to-regexp":5}],7:[function(g,f,e){f.exports=["get","post","put","head","delete","options","trace","copy","lock","mkcol","move","purge","propfind","proppatch","unlock","report","mkactivity","checkout","merge","m-search","notify","subscribe","unsubscribe","patch","search","connect"]},{}],8:[function(e,g,j){var i=e("layer");var h=e("../methods.js");var l=_;g.exports=k;function k(n){this.path=n;this.stack=[];this.methods={}}k.prototype._handles_method=function f(n){if(this.methods._all){return true}n=n.toLowerCase();if(n==="head"&&!this.methods.head){n="get"}return Boolean(this.methods[n])};k.prototype._options=function m(){var n=Object.keys(this.methods);if(this.methods.get&&!this.methods.head){n.push("head")}for(var o=0;o<n.length;o++){n[o]=n[o].toUpperCase()}return n};k.prototype.dispatch=function(s,q,p){var o=0;var n=this.stack;if(n.length===0){return p()}var t=s.method.toLowerCase();if(t==="head"&&!this.methods.head){t="get"}s.route=this;r();function r(v){if(v&&v==="route"){return p()}var u=n[o++];if(!u){return p(v)}if(u.method&&u.method!==t){return r(v)}if(v){u.handle_error(v,s,q,r)}else{u.handle_request(s,q,r)}}};k.prototype.all=function(){var n=l.flatten([].slice.call(arguments));n.forEach(function(q){if(typeof q!=="function"){var p={}.toString.call(q);var r="Route.all() requires callback functions but got a "+p;throw new Error(r)}var o=i("/",{},q);o.method=undefined;this.methods._all=true;this.stack.push(o)},this);return this};h.forEach(function(n){k.prototype[n]=function(){var o=l.flatten([].slice.call(arguments));o.forEach(function(r){if(typeof r!=="function"){var q={}.toString.call(r);var s="Route."+n+"() requires callback functions but got a "+q;throw new Error(s)}var p=i("/",{},r);p.method=n;this.methods[n]=true;this.stack.push(p)},this);return this}})},{layer:6,"../methods.js":7}],9:[function(g,f,e){e.mixin=function(l,h,k){var l=l||{},i,k=k||false;for(i in h){if(h.hasOwnProperty(i)){if(typeof l[i]!="undefined"&&k){continue}var j=h[i];l[i]=j}}return l};e.merge=function(i,h,k){if(i&&h){for(var j in h){i[j]=_.isFunction(h[j])&&k?h[j].bind(k):h[j]}}return i};e.escapeHTML=function(h){return String(h).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}},{}],10:[function(h,f,x){var g=h("./route.js");var i=h("layer");var w=h("../methods.js");var e=h("../utils.js");var p=/^\[object (\S+)\]$/;var r=Array.prototype.slice;var s=Object.prototype.toString;var q=f.exports=function(z){z=z||{};function y(C,A,B){y.handle(C,A,B)}y=e.mixin(y,q);y.params={};y._params=[];y.caseSensitive=z.caseSensitive;y.mergeParams=z.mergeParams;y.strict=z.strict;y.stack=[];return y};q.handle=function(y,O,J){var I=this;var G=1+y.url.indexOf("?");var M=G?G-1:y.url.length;var D=y.url[0]!=="/"&&1+y.url.substr(0,M).indexOf("://");var N=D?y.url.substr(0,y.url.indexOf("/",2+D)):"";var H=0;var L="";var A=false;var F={};var z=[];var B=I.stack;var E=y.params;var P=y.baseUrl||"";J=v(J,y,"baseUrl","next","params");y.next=K;if(y.method==="OPTIONS"){J=l(J,function(Q,R){if(R||z.length===0){return Q(R)}o(O,z,Q)})}y.baseUrl=P;y.originalUrl=y.originalUrl||y.url;K();function K(R){var W=R==="route"?null:R;if(A){y.url=y.url.substr(1);A=false}if(L.length!==0){y.baseUrl=P;y.url=N+L+y.url.substr(N.length);L=""}if(H>=B.length){setImmediate(J,W);return}var Y=y.path||y.host;if(Y==null){return J(W)}var U;var T;var X;while(T!==true&&H<B.length){U=B[H++];T=u(U,Y);X=U.route;if(typeof T!=="boolean"){W=W||T}if(T!==true){continue}if(!X){continue}if(W){T=false;continue}var Q=y.method;var V=X._handles_method(Q);if(!V&&Q==="OPTIONS"){m(z,X._options())}if(!V&&Q!=="HEAD"){T=false;continue}}if(T!==true){return J(W)}if(X){y.route=X}y.params=I.mergeParams?j(U.params,E):U.params;var S=U.path;I.process_params(U,F,y,O,function(Z){if(Z){return K(W||Z)}if(X){return U.handle_request(y,O,K)}C(U,W,S,Y)})}function C(R,Q,T,S){var U=S[T.length];if(U&&"/"!==U&&"."!==U){return K(Q)}if(T.length!==0){L=T;y.url=N+y.url.substr(N.length+L.length);if(!D&&y.url[0]!=="/"){y.url="/"+y.url;A=true}y.baseUrl=P+(L[L.length-1]==="/"?L.substring(0,L.length-1):L)}if(Q){R.handle_error(Q,y,O,K)}else{R.handle_request(y,O,K)}}};q.use=function t(z){var C=0;var B="/";if(typeof z!=="function"){var y=z;while(_.isArray(y)&&y.length!==0){y=y[0]}if(typeof y!=="function"){C=1;B=z}}var A=_.flatten(r.call(arguments,C));if(A.length===0){throw new TypeError("Router.use() requires middleware functions")}A.forEach(function(E){if(typeof E!=="function"){throw new Error("Router.use() requires middleware function but got a "+(typeof E))}var D=new i(B,{sensitive:this.caseSensitive,strict:false,end:false},E);D.route=undefined;this.stack.push(D)},this);return this};q.param=function k(A,C){if(typeof A==="function"){this._params.push(A);return}var D=this._params;var y=D.length;var z;if(A[0]===":"){A=A.substr(1)}for(var B=0;B<y;++B){if(z=D[B](A,C)){C=z}}if("function"!=typeof C){throw new Error("invalid param() call for "+A+", got "+C)}(this.params[A]=this.params[A]||[]).push(C);return this};q.process_params=function(E,J,H,G,C){var A=this.params;var M=E.keys;if(!M||M.length===0){return C()}var D=0;var y;var N=0;var L;var K;var I;var F;function z(O){if(O){return C(O)}if(D>=M.length){return C()}N=0;L=M[D++];if(!L){return C()}y=L.name;K=H.params[y];I=A[y];F=J[y];if(K===undefined||!I){return z()}if(F&&(F.error||F.match===K)){H.params[y]=F.value;return z(F.error)}J[y]=F={error:null,match:K,value:K};B()}function B(P){var O=I[N++];F.value=H.params[L.name];if(P){F.error=P;z(P);return}if(!O){return z()}try{O(H,G,B,K,L.name)}catch(Q){B(Q)}}z()};q.route=function(A){var y=new g(A);var z=new i(A,{sensitive:this.caseSensitive,strict:this.strict,end:true},y.dispatch.bind(y));z.route=y;this.stack.push(z);return y};w.concat("all").forEach(function(y){q[y]=function(A){var z=this.route(A);z[y].apply(z,r.call(arguments,1));return this}});function m(A,y){for(var z=0;z<y.length;z++){var B=y[z];if(A.indexOf(B)===-1){A.push(B)}}}function n(z){var y=typeof z;if(y!=="object"){return y}return s.call(z).replace(p,"$1")}function u(y,A){try{return y.match(A)}catch(z){return z}}function j(C,z){if(typeof z!=="object"||!z){return C}var A=mixin({},z);if(!(0 in C)||!(0 in z)){return mixin(A,C)}var y=0;var B=0;while(y===B||B in z){if(y in C){y++}if(B in z){B++}}for(y--;y>=0;y--){C[y+B]=C[y];if(y<B){delete C[y]}}return mixin(z,C)}function v(A,C){var z=new Array(arguments.length-2);var B=new Array(arguments.length-2);for(var y=0;y<z.length;y++){z[y]=arguments[y+2];B[y]=C[z[y]]}return function(E){for(var D=0;D<z.length;D++){C[z[D]]=B[D]}return A.apply(this,arguments)}}function o(A,z,B){try{var y=z.join(",");A.set("Allow",y);A.send(y)}catch(C){B(C)}}function l(y,A){return function z(){var C=new Array(arguments.length+1);C[0]=y;for(var D=0,B=arguments.length;D<B;D++){C[D+1]=arguments[D]}A.apply(this,C)}}},{"./route.js":8,layer:6,"../methods.js":7,"../utils.js":9}],11:[function(i,j,l){var m=path.dirname;var o=path.basename;var n=path.extname;var h=path.join;var p=path.resolve;j.exports=e;function e(r,q){q=q||{};this.name=r;this.root=q.root;var t=q.engines;this.defaultEngine=q.defaultEngine;var s=this.ext=n(r);if(!s&&!this.defaultEngine){throw new Error("No default engine was specified and no extension was provided.")}if(!s){r+=(s=this.ext=("."!=this.defaultEngine[0]?".":"")+this.defaultEngine)}this.engine=t[s]||(t[s]=require(s.slice(1)).__express);this.path=this.lookup(r)}e.prototype.lookup=function k(t){var w;var r=[].concat(this.root);for(var v=0;v<r.length&&!w;v++){var q=r[v];var x=p(q,t);var s=m(x);var u=o(x);w=this.resolve(s,u)}return w};e.prototype.render=function f(q,r){this.engine(this.path,q,r)};e.prototype.resolve=function p(q,s){var u=this.ext;var r;var t;r=p(q,s);if(!/^\w:\\/.test(r)){r=path.server(r)}t=g(r);if(t&&t.isFile()){return r}r=p(q,o(s,u),"index"+u);t=g(r);if(t&&t.isFile()){return r}};function g(r){try{return fs.stats(r)}catch(q){return undefined}}},{}],12:[function(h,g,f){var e=h("./utils.js");f.init=function(j){return function i(m,k,l){if(j.enabled("x-powered-by")){k.set("X-Powered-By","Express")}m.res=k;k.req=m;m.next=l;e.merge(m,j.request);e.merge(k,j.response);k.locals=j.locals;k.render=j.render.bind(j);l()}}},{"./utils.js":9}],13:[function(g,h,l){var i=g("./router");var m=g("./utils.js");var k=g("./methods.js");var f=g("./view.js");var n=g("./midware.js");var j=l=h.exports={};var o=Array.prototype.slice;j.settings={title:null,version:null,env:null,"jsonp callback name":null,"json replacer JSON replacer":null,"default file":null,"case sensitive routing":null,"strict routing":null,"view cache":null,"view engine":null,views:null,"render engine":null,"render engine ext":null,engines:null,cache:null,view:null,"x-powered-by":null};j.init=function(){this.cache={};this.settings={};this.engines={};this.defaultConfiguration()};j.defaultConfiguration=function(){this.set("title","Series Express");this.set("version","1.0.105");var p=process.env.SERIES_ENV||"development";this.set("env",p);this.set("jsonp callback name","jsonp");this.set("default file","default.asp");this.disable("case sensitive routing");this.disable("strict routing");this.enable("view cache");this.set("view engine","ejs");this.set("views",path.resolve("views"));this.set("render engine ext",".ejs");this.set("engines",{});this.set("cache",{});this.set("view",f);this.enable("x-powered-by");if(p==="production"){this.enable("view cache")}};j.on=function(q,p){if(!this.evs){this.evs={}}if(!this.evs[q]){this.evs[q]=[]}this.evs[q].push(p)};j.emit=function(){var q=arguments[0];var p=[].concat(o.call(arguments,1));if(this.evs&&this.evs[q]&&_.isArray(this.evs[q])){_.each(this.evs[q],function(r){if(_.isFunction(r)){r.apply(null,p)}})}};j.handle=function(s,r,p){var q=this._router;if(!q){p();return}q.handle(s,r);p()};j.lazyrouter=function(){if(!this._router){this._router=new i({caseSensitive:this.enabled("case sensitive routing"),strict:this.enabled("strict routing")});this._router.use(n.init(this))}};j.set=function(p,q){if(arguments.length===1){return this.settings[p]}this.settings[p]=q;return this};j.locals=function(p,r){var q=this;if(!r){_.each(p,function(s,t){q.locals[t]=s})}else{q.locals[p]=r}};j.enabled=function(p){return !!this.set(p)};j.disabled=function(p){return !this.set(p)};j.enable=function(p){return this.set(p,true)};j.disable=function(p){return this.set(p,false)};j.parseURL=function(s){var q=process.env.QUERY_STRING;var u=this.get("default file");if(/^404\;/.test(q)){q=q.split(";")[1].split("/");var r;if(q.length>2){r=q.slice(0,2);s.host=q.slice(2,3).join("/").replace(":80","");r.push(s.host);r=r.concat(q.slice(3));q=[""].concat(q.slice(3)).join("/");s.url=r.join("/")}else{s.host=q.slice(2).join("/").replace(":80","");q="/";s.url=q.join("/")}}else{q=process.env.PATH_INFO;s.url="http://"+process.env.HTTP_HOST+(process.env.SERVER_PORT=="80"?"":":"+process.env.SERVER_PORT)+process.env.PATH_INFO;s.host=process.env.HTTP_HOST;if(q.toLowerCase()==="/"+u.toLowerCase()){q="/"}}var p=q.indexOf("?");if(p>-1){var t=q.substring(p+1).replace(/^\&/,"");s.query=_.fromQuery(t);q=q.substring(0,p)}return q};j.use=function e(s){var u=0;var t="/";if(typeof s!=="function"){var p=s;while(_.isArray(p)&&p.length!==0){p=p[0]}if(typeof p!=="function"){u=1;t=s}}var r=_.flatten(o.call(arguments,u));if(r.length===0){throw new TypeError("app.use() requires middleware functions")}this.lazyrouter();var q=this._router;r.forEach(function(w){if(!w||!w.handle||!w.set){return q.use(t,w)}w.mountpath=t;w.parent=this;q.use(t,function v(z,x,y){var A=z.app;w.handle(z,x,function(B){z=m.mixin(z,A.request);x=m.mixin(x,A.response);y(B)})})},this);return this};j.route=function(p){this.lazyrouter();return this._router.route(p)};j.engine=function(q,p){if("function"!=typeof p){throw new Error("callback function required")}if("."!=q[0]){q="."+q}this.engines[q]=p;return this};j.param=function(p,q){this.lazyrouter();if(_.isArray(p)){p.forEach(function(r){this.param(r,q)},this);return this}this._router.param(p,q);return this};j.path=function(){return this.parent?this.parent.path()+this.mountpath:""};k.forEach(function(p){j[p]=function(r){if("get"==p&&1==arguments.length){return this.set(r)}this.lazyrouter();var q=this._router.route(r);q[p].apply(q,o.call(arguments,1));return this}});j.all=function(r){this.lazyrouter();var p=this._router.route(r);var q=o.call(arguments,1);k.forEach(function(s){p[s].apply(p,q)});return this};j.render=function(t,x,v){var p={};var r=this.cache;var q=this.engines;var w;if("function"==typeof x){v=x,x={}}m.merge(p,this.locals);if(x._locals){m.merge(p,x._locals)}m.merge(p,x);p.cache=null==p.cache?this.enabled("view cache"):p.cache;if(p.cache){w=r[t]}if(!w){w=new (this.get("view"))(t,{defaultEngine:this.get("view engine"),root:this.get("views"),engines:q});if(!w.path){var s=_.isArray(w.root)&&w.root.length>1?'directories "'+w.root.slice(0,-1).join('", "')+'" or "'+w.root[w.root.length-1]+'"':'directory "'+w.root+'"';var u=new Error('Failed to lookup view "'+t+'" in views '+s);u.view=w;return v(u)}if(p.cache){r[t]=w}}try{w.render(p,v)}catch(u){v(u)}};j.listen=function(){var p=this.response;this(this.request,p,function(){p.end()});return this}},{"./router":10,"./utils.js":9,"./methods.js":7,"./view.js":11,"./midware.js":12}],14:[function(g,f,e){f.exports=function(){var h=arguments;return function(o,m,n){var j=m.app.get("views");for(var l=0;l<h.length;l++){var k=h[l];if(!/^\w:\\/.test(k)){k=path.server(k)}if(fs.exist(k)){j=h[l]}}m.app.set("views",j);n()}}},{}],15:[function(h,f,e){f.exports=function(){return function(l,j,k){i(l,j);l.sessions=g();k()}};function g(){var j=new Object();_.enumerate(Session.Contents,function(k){j[k]=Session(k)});return j}function i(k,j){j.session=function(l,m){if(_.isObject(l)){_.each(l,function(n,o){j.session(o,n)})}else{if(!m){return Session(l)}else{Session(l)=m;k.sessions=g()}}};j.session.timeout=function(l){Session.Timeout=l||20};j.session.end=function(){Session.Abandon()};j.session.remove=function(l){try{Session.Contents.Remove(l);k.sessions=g()}catch(m){}};j.session.destory=function(){Session.Contents.RemoveAll();k.sessions=g()};j.session.count=function(){return Session.Contents.Count}}},{}],16:[function(h,g,f){g.exports=function(){return function(l,j,k){e(l,j);l.applications=i();k()}};function i(){var j=new Object();_.enumerate(Application.Contents,function(k){j[k]=Application(k)});return j}function e(k,j){j.application=function(l,m){if(_.isObject(l)){_.each(l,function(n,o){j.application(o,n)})}else{if(!m){return Application(l)}else{Application(l)=m;k.applications=i()}}};j.application.lock=function(l){Application.Lock()};j.application.unlock=function(){Application.Unlock()};j.application.remove=function(l){try{Application.Contents.Remove(l);k.applications=i()}catch(m){}};j.application.destory=function(){Application.Contents.RemoveAll();k.applications=i()};j.application.count=function(){return Application.Contents.Count}}},{}],17:[function(i,g,f){var k=i("cookie");g.exports=function(){var o,l=false,q,m={};for(var n=0;n<arguments.length;n++){if(_.isBoolean(arguments[n])){l=arguments[n]}else{if(_.isString(arguments[n])){o=arguments[n]}else{if(_.isNumber(arguments[n])){q=new Date(new Date().getTime()+arguments[n])}else{if(_.isDate(arguments[n])){q=arguments}else{if(_.isObject(arguments[n])){m=arguments[n]}}}}}}var p=m;if(l){p.httponly=l}if(q){p.expires=q}return function(t,r,s){h(t,r,o,p);j(t,r,o);s()}};function j(n,m,l){n.cookies=e(l)||{}}function e(l){if(l){var m=k.cookie(l);if(m){return _.fromQuery(m)}else{return{}}}else{var n={};_.each(k.cookie(),function(p,o){if(p.indexOf("=")>-1){n[o]=_.fromQuery(p)}else{n[o]=p}});return n}}function h(o,m,l,n){m.cookie=function(p,q){if(_.isObject(p)){_.each(p,function(r,s){m.cookie(s,r)})}else{if(_.isUndefined(q)||_.isNull(q)){return o.cookies[p]}else{q=String(q)||q;if(q.length===0){delete o.cookies[p]}else{o.cookies[p]=q}if(l){k.cookie(l,_.toQuery(o.cookies),n)}else{k.cookie(p,q,n)}}}};m.cookie.remove=function(p){if(!o.cookies[p]){return true}var q=n.expires;n.expires=-1;m.cookie(p,"");if(o.cookies[p]){delete o.cookies[p]}n.expires=q;return !o.cookies[p]};m.cookie.destory=function(p){k.removeCookie(p,n);if(o.cookies[p]){delete o.cookies[p]}}}},{cookie:3}],18:[function(g,f,e){f.exports=function(){return function(j,h,i){j.body=j.formAll();i()}}},{}],19:[function(g,f,e){f.exports=function(h){if(_.isUndefined(h)){h={}}if(_.isString(h)){h={jsonp:h}}if(_.isFunction(h)){h={jsonpCallback:h}}return function(k,i,j){var n=k.app;if(_.isString(h.jsonp)){n.set("jsonp callback name",h.jsonp)}if(_.isFunction(h.jsonpCallback)){n.set("json replacer JSON replacer",h.jsonpCallback)}var m=n.get("json replacer JSON replacer");var l=n.get("jsonp callback name");if(_.isString(l)&&_.isFunction(m)){l=m(l)}l=k.query[l];if(l){i.handles.push(function(p,o){o.set("Content-Type","application/json; Charset=utf-8");return l+"("+JSON.stringify(o._jsons)+")"})}j()}}},{}],20:[function(l,i,f){var k=l("./request.js");var h=l("./response.js");var j=l("./application.js");var e=l("./utils.js");f=i.exports=g;function g(){var m=function(p,n,o){m.handle(p,n,o)};m.request=k;m.response=h;m.request.app=m.response.app=m;e.merge(m,j);m.init();k.path=m.parseURL(k);return m}f.application=j;f.request=k;f.response=h;g.template=l("./middlewares/template.js");g.sessionParse=l("./middlewares/sessionParse.js");g.applicationParse=l("./middlewares/applicationParse.js");g.cookieParse=l("./middlewares/cookieParse.js");g.bodyParse=l("./middlewares/bodyParse.js");g.jsonpParse=l("./middlewares/jsonpParse.js")},{"./request.js":2,"./response.js":4,"./application.js":13,"./utils.js":9,"./middlewares/template.js":14,"./middlewares/sessionParse.js":15,"./middlewares/applicationParse.js":16,"./middlewares/cookieParse.js":17,"./middlewares/bodyParse.js":18,"./middlewares/jsonpParse.js":19}],21:[function(g,f,e){f.exports=g("./lib/express.js")},{"./lib/express.js":20}]},{},[21])(21)});